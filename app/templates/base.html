<!doctype html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LeetCode Profile Visualiser | Analyze & Compare LeetCode Stats</title>
    <meta name="description"
        content="Visualise your LeetCode progress with beautiful charts. Analyze your problem solving stats, contest rankings, and compare profiles with friends." />
    <meta name="keywords"
        content="LeetCode, Visualiser, Visualizer, LeetCode Stats, LeetCode Profile, Coding Interview, Data Structures, Algorithms, Contest Ranking, Profile Comparison, LeetCode Analysis, LeetCode Charts" />
    <meta name="author" content="Shubham Lohan" />
    <link rel="canonical"
        href="https://leetcode-visualiser.vercel.app{{ request.url.path if request.url.path != '/' else '' }}" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "LeetCode Visualiser",
      "applicationCategory": "DeveloperApplication",
      "operatingSystem": "Web",
      "offers": { "@type": "Offer", "price": "0", "priceCurrency": "USD" },
      "description": "Visualise your LeetCode progress with beautiful charts.",
      "author": { "@type": "Person", "name": "Shubham Lohan" }
    }
    </script>

    <meta property="og:type" content="website" />
    <meta property="og:url" content="{{ request.url }}" />
    <meta property="og:title"
        content="{% if og_title %}{{ og_title }} | LeetCode Visualiser{% else %}LeetCode Profile Visualiser{% endif %}" />
    <meta property="og:description"
        content="{% if og_description %}{{ og_description }}{% else %}Visualise your LeetCode progress with beautiful charts.{% endif %}" />
    <meta property="og:image"
        content="{% if og_image %}{{ og_image }}{% else %}https://leetcode-visualiser.vercel.app/static/img/preview.png{% endif %}" />

    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="{{ request.url }}" />
    <meta property="twitter:title"
        content="{% if og_title %}{{ og_title }} | LeetCode Visualiser{% else %}LeetCode Profile Visualiser{% endif %}" />
    <meta property="twitter:description"
        content="{% if og_description %}{{ og_description }}{% else %}Visualise your LeetCode progress with beautiful charts.{% endif %}" />
    <meta property="twitter:image"
        content="{% if og_image %}{{ og_image }}{% else %}https://leetcode-visualiser.vercel.app/static/img/preview.png{% endif %}" />

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />

    <!-- ApexCharts -->
    <script src="https://cdn.jsdelivr.net/npm/apexcharts@3.44.0"></script>

    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HRHBX7SPTM"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-HRHBX7SPTM');
    </script>

    <!-- Theme initialization (prevent flash) -->
    <script>
        (function () {
            const saved = localStorage.getItem('lv-theme');
            if (saved) document.documentElement.setAttribute('data-theme', saved);
        })();
    </script>

    <link rel="stylesheet" href="{{ url_for('static', path='css/main.css') }}" />
    <link rel="icon" type="image/svg+xml" href="{{ url_for('static', path='img/favicon.svg') }}" />

    {% block extra_head %}{% endblock %}
</head>

<body>
    <!-- Loading Overlay -->
    <div id="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p>Analyzing Profile...</p>
        </div>
    </div>

    <!-- Navbar -->
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <polyline points="16 18 22 12 16 6"></polyline>
                    <polyline points="8 6 2 12 8 18"></polyline>
                </svg>
                <span>LeetCode Visualiser</span>
            </a>

            {% if users %}
            <div class="navbar-search">
                {% block compact_search_form %}{% endblock %}
            </div>
            {% endif %}

            <div class="navbar-actions">
                <a href="{{ url_for('comparison_form') }}" class="btn btn-ghost">
                    <i class="fas fa-code-compare"></i>
                    <span class="hide-mobile">Compare</span>
                </a>
                <button class="btn-icon theme-toggle" onclick="toggleTheme()" aria-label="Toggle theme">
                    <i class="fas fa-moon"></i>
                    <i class="fas fa-sun"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main>
        {% if error %}
        <div class="container">
            {{ error|safe }}
            <div class="text-center mt">
                <a href="{{ url_for('index') }}" class="btn btn-ghost">
                    <i class="fas fa-arrow-left"></i> Back to Home
                </a>
            </div>
        </div>
        {% else %}
            {% block content %}{% endblock %}
        {% endif %}
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>LeetCode Visualiser &copy; <span id="currentYear"></span> &middot;
                Created by <a href="https://shubham-lohan.github.io/" target="_blank">Shubham Lohan</a></p>
            <p style="margin-top:4px">Not affiliated with LeetCode. Created for educational purposes.</p>
        </div>
    </footer>

    <script>
        // Year
        document.getElementById("currentYear").textContent = new Date().getFullYear();

        // Loading overlay on form submit
        document.addEventListener("DOMContentLoaded", function () {
            document.querySelectorAll("form").forEach(function (form) {
                form.addEventListener("submit", function () {
                    document.getElementById("loading-overlay").style.display = "block";
                });
            });
        });

        // Theme toggle
        function toggleTheme() {
            const html = document.documentElement;
            const current = html.getAttribute('data-theme');
            const next = current === 'dark' ? 'light' : 'dark';
            html.setAttribute('data-theme', next);
            localStorage.setItem('lv-theme', next);
            // Re-render charts if they exist
            if (typeof reRenderCharts === 'function') reRenderCharts();
        }
    </script>

    <script src="{{ url_for('static', path='js/dashboard.js') }}"></script>

    {% block extra_scripts %}{% endblock %}
</body>

</html>